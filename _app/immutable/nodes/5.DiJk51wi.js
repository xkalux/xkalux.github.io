import{d as Be,f as h,a as d,c as le,s as x}from"../chunks/BOX8SYRG.js";import{i as $e}from"../chunks/J4k10p99.js";import{o as Ce}from"../chunks/0g7lm0Hi.js";import{Q as Ee,a1 as Me,aB as ze,Z as Ie,z as Le,A as oe,B as Ne,C as Z,E as B,G as We,a as e,H as q,I as o,s as P,u as l,M as n,F as L}from"../chunks/Db4QX34E.js";import{B as De,i as D}from"../chunks/H1mLmQGd.js";import{i as U,l as Je,e as ie,a as Oe}from"../chunks/CHlFfwPK.js";import{a as X,s as J}from"../chunks/u531CL-n.js";import{s as Te}from"../chunks/ByYXGTG7.js";import{s as je,a as Fe}from"../chunks/DWhKGWJG.js";import{w as Ge}from"../chunks/C2j6gFa2.js";import{a as He}from"../chunks/Dcnj4eNK.js";function Ke(A,b,v){Ee&&Me();var O=new De(A),T=!ze();Ie(()=>{var a=b();T&&a!==null&&typeof a=="object"&&(a={}),O.ensure(a,v)})}const Y=Ge([]);async function fe(){U.set(!0),Je.set("fetch slides");const A=X.slide.load();if(A){Y.set(A),U.set(!1);return}const b=await He.getSlides();b.error||(Y.set(b.data),X.slide.save(b.data)),U.set(!1)}var Qe=h('<button class="flex items-center gap-2 w-full text-left hover:text-info" title="Toggle"><span class="icon material-symbols-outlined svelte-wfcbff"> </span> <span class="label truncate svelte-wfcbff"> </span></button>'),Re=h('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 w-full group hover:text-info-content hover:font-semibold svelte-wfcbff"><span class="icon material-symbols-outlined svelte-wfcbff"> </span> <span class="label truncate svelte-wfcbff"> </span></a>'),Ve=h('<span class="label truncate w-full svelte-wfcbff"> </span>'),Ze=h('<li class="my-1"><div class="tree-row group flex items-center gap-2 rounded-md px-2 py-1 w-full hover:bg-base-200 svelte-wfcbff"><!></div></li>'),qe=h('<ul class="children-group mt-2 w-full svelte-wfcbff" style="--group-depth: 1"></ul>'),Pe=h('<li class="px-3 pt-3 pb-1"><button class="tree-row group flex items-center gap-2 w-full text-left rounded-md px-2 py-1 hover:bg-base-200 hover:text-info svelte-wfcbff" style="--depth: 0"><span class="icon material-symbols-outlined svelte-wfcbff" aria-hidden="true"> </span> <span class="label font-semibold truncate svelte-wfcbff"> </span></button> <!></li>'),Ue=h('<div class=" w-full max-w-none"><ul class="w-full"></ul></div>'),Xe=h('<div class="pl-6 w-full max-w-none"><!></div> <div class="fab"><div tabindex="0" role="button" class="btn btn-lg btn-circle mb-15"><span class="icon material-symbols-outlined" aria-hidden="true">settings</span></div> <button class="btn btn-s text-xs"><span class="icon material-symbols-outlined" aria-hidden="true">delete_forever</span>Clear Cache</button></div>',1);function ct(A,b){Le(b,!1);const v=()=>Fe(Y,"$slides",O),[O,T]=je();let a=q(new Set);const ee=t=>{e(a).has(t)?e(a).delete(t):e(a).add(t),P(a,new Set(e(a)))},ce=t=>e(a).has(t);function j(t){if(Array.isArray(t))return t.filter(Boolean);if(typeof t=="string")try{const r=JSON.parse(t);return Array.isArray(r)?r.filter(Boolean):[]}catch{return[]}return[]}function F(t){if(Array.isArray(t))return t.filter(Boolean);if(typeof t=="string")try{const r=JSON.parse(t);return Array.isArray(r)?r.filter(Boolean):[]}catch{return[]}return[]}function de(t){if(!t)return"attach_file";const r=t.toLowerCase();return r.startsWith("https://drive.google.com/drive")?"drive_export":r.startsWith("https://docs.google.com/document/")?"docs":r.startsWith("https://docs.google.com/presentation/")?"file_present":"attach_file"}function te(t,r,p,$,u){j(t).forEach((c,g)=>{if(!c)return;const C=r?`${r}.${g}`:`${g}`;$.push({node:c,path:C,depth:p,rootIndex:u});const w=F(c.children);w.length>0&&ce(C)&&te(w,C,p+1,$,u)})}Ce(async()=>{await fe()});let N=q([]),G=q([]);function pe(t,r){const p=[];return j(t).forEach((u,i)=>{if(!u)return;const c=String(i);p.push({node:u,path:c,depth:0,rootIndex:i});const g=F(u.children);r.has(c)&&g.length>0&&te(g,c,1,p,i)}),p}oe(()=>v(),()=>{const t=Array.isArray(v())?v().filter(Boolean):[];P(N,t.map(r=>({name:r?.NAME??"(ไม่มีชื่อ)",children:j(r?.DATA)})))}),oe(()=>(e(N),e(a)),()=>{P(G,pe(e(N),e(a)))}),Ne(),$e();var ae=Xe(),H=Z(ae),ue=o(H);{var ve=t=>{var r=Ue(),p=o(r);ie(p,5,()=>e(N),Oe,($,u,i)=>{var c=le(),g=Z(c);Ke(g,()=>i,C=>{var w=Pe(),E=o(w);E.__click=()=>ee(String(i));var K=o(E),_e=o(K,!0);n(K);var re=B(K,2),he=o(re,!0);n(re),n(E);var be=B(E,2);{var ge=M=>{var z=qe();ie(z,5,()=>(e(G),l(()=>e(G).filter(S=>S.rootIndex===i&&S.depth>=1))),S=>S.path,(S,s)=>{var Q=Ze(),R=o(Q),ye=o(R);{var xe=k=>{var m=Qe();m.__click=()=>ee(e(s).path);var I=o(m),V=o(I,!0);n(I);var W=B(I,2),_=o(W,!0);n(W),n(m),L((f,y)=>{J(m,"aria-expanded",f),x(V,y),x(_,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))},[()=>(e(a),e(s),l(()=>e(a).has(e(s).path))),()=>(e(a),e(s),l(()=>e(a).has(e(s).path)?"folder_open":"folder"))]),d(k,m)},Ae=k=>{var m=le(),I=Z(m);{var V=_=>{var f=Re(),y=o(f),we=o(y,!0);n(y);var ne=B(y,2),Se=o(ne,!0);n(ne),n(f),L(ke=>{J(f,"href",(e(s),l(()=>e(s).node.url))),J(f,"title",(e(s),l(()=>e(s).node.url))),x(we,ke),x(Se,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))},[()=>(e(s),l(()=>de(e(s).node.url)))]),d(_,f)},W=_=>{var f=Ve(),y=o(f,!0);n(f),L(()=>x(y,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))),d(_,f)};D(I,_=>{e(s),l(()=>e(s).node?.url)?_(V):_(W,!1)},!0)}d(k,m)};D(ye,k=>{e(s),l(()=>F(e(s).node?.children).length>0)?k(xe):k(Ae,!1)})}n(R),n(Q),L(()=>Te(R,`--depth: ${e(s),l(()=>e(s).depth)??""}`)),d(S,Q)}),n(z),d(M,z)};D(be,M=>{e(a),l(()=>e(a).has(String(i)))&&M(ge)})}n(w),L((M,z)=>{J(E,"aria-expanded",M),x(_e,z),x(he,(e(u),l(()=>e(u)?.name??"(ไม่มีชื่อ)")))},[()=>(e(a),l(()=>e(a).has(String(i)))),()=>(e(a),l(()=>e(a).has(String(i))?"folder_open":"folder"))]),d(C,w)}),d($,c)}),n(p),n(r),d(t,r)};D(ue,t=>{v(),l(()=>Array.isArray(v())&&v().length>0)&&t(ve)})}n(H);var se=B(H,2),me=B(o(se),2);me.__click=async()=>{X.slide.destroy(),await fe()},n(se),d(A,ae),We(),T()}Be(["click"]);export{ct as component};

import{d as Be,f as h,a as d,c as le,s as x}from"../chunks/CsIN25Ky.js";import{i as $e}from"../chunks/PcqcHE3R.js";import{a as Ce}from"../chunks/BINHKKf2.js";import{M as Ee,_ as Me,az as ze,W as We,z as Ie,A as oe,B as Je,C as P,E as B,H as Le,a as e,I as Q,F as o,s as U,u as l,J as n,G as I}from"../chunks/BIYywunZ.js";import{B as Ne,i as N}from"../chunks/CRXV3zYL.js";import{i as X,l as De,e as ie,a as Oe}from"../chunks/1oHT7Rzc.js";import{s as Y,a as D}from"../chunks/Cx1DLMHF.js";import{s as Te}from"../chunks/BnCyje76.js";import{s as je,a as Fe}from"../chunks/CVuxcOWQ.js";import{w as Ge}from"../chunks/Cu0YfLRo.js";import{a as He}from"../chunks/BX0cc14o.js";function Ke(A,b,v){Ee&&Me();var O=new Ne(A),T=!ze();We(()=>{var a=b();T&&a!==null&&typeof a=="object"&&(a={}),O.ensure(a,v)})}const Z=Ge([]);async function fe(){X.set(!0),De.set("fetch slides");const A=Y.slide.load();if(A){Z.set(A),X.set(!1);return}const b=await He.getSlides();b.error||(Z.set(b.data),Y.slide.save(b.data)),X.set(!1)}var Re=h('<button class="flex items-center gap-2 w-full text-left hover:text-info" title="Toggle"><span class="icon material-symbols-outlined svelte-wfcbff"> </span> <span class="label truncate svelte-wfcbff"> </span></button>'),Ve=h('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 w-full group hover:text-info-content hover:font-semibold svelte-wfcbff"><span class="icon material-symbols-outlined svelte-wfcbff"> </span> <span class="label truncate svelte-wfcbff"> </span></a>'),qe=h('<span class="label truncate w-full svelte-wfcbff"> </span>'),Pe=h('<li class="my-1"><div class="tree-row group flex items-center gap-2 rounded-md px-2 py-1 w-full hover:bg-base-200 svelte-wfcbff"><!></div></li>'),Qe=h('<ul class="children-group mt-2 w-full svelte-wfcbff" style="--group-depth: 1"></ul>'),Ue=h('<li class="px-3 pt-3 pb-1"><button class="tree-row group flex items-center gap-2 w-full text-left rounded-md px-2 py-1 hover:bg-base-200 hover:text-info svelte-wfcbff" style="--depth: 0"><span class="icon material-symbols-outlined svelte-wfcbff" aria-hidden="true"> </span> <span class="label font-semibold truncate svelte-wfcbff"> </span></button> <!></li>'),Xe=h('<div class=" w-full max-w-none"><ul class="w-full"></ul></div>'),Ye=h('<div class="pl-6 w-full max-w-none"><!></div> <div class="fab"><div tabindex="0" role="button" class="btn btn-lg btn-circle mb-15"><span class="icon material-symbols-outlined" aria-hidden="true">settings</span></div> <button class="btn btn-s text-xs"><span class="icon material-symbols-outlined" aria-hidden="true">delete_forever</span>Clear Cache</button></div>',1);function ct(A,b){Ie(b,!1);const v=()=>Fe(Z,"$slides",O),[O,T]=je();let a=Q(new Set);const ee=t=>{e(a).has(t)?e(a).delete(t):e(a).add(t),U(a,new Set(e(a)))},ce=t=>e(a).has(t);function j(t){if(Array.isArray(t))return t.filter(Boolean);if(typeof t=="string")try{const r=JSON.parse(t);return Array.isArray(r)?r.filter(Boolean):[]}catch{return[]}return[]}function F(t){if(Array.isArray(t))return t.filter(Boolean);if(typeof t=="string")try{const r=JSON.parse(t);return Array.isArray(r)?r.filter(Boolean):[]}catch{return[]}return[]}function de(t){if(!t)return"attach_file";const r=t.toLowerCase();return r.startsWith("https://drive.google.com/drive")?"drive_export":r.startsWith("https://docs.google.com/document/")?"docs":r.startsWith("https://docs.google.com/presentation/")?"file_present":"attach_file"}function te(t,r,p,$,u){j(t).forEach((c,g)=>{if(!c)return;const C=r?`${r}.${g}`:`${g}`;$.push({node:c,path:C,depth:p,rootIndex:u});const w=F(c.children);w.length>0&&ce(C)&&te(w,C,p+1,$,u)})}Ce(async()=>{await fe()});let J=Q([]),G=Q([]);function pe(t,r){const p=[];return j(t).forEach((u,i)=>{if(!u)return;const c=String(i);p.push({node:u,path:c,depth:0,rootIndex:i});const g=F(u.children);r.has(c)&&g.length>0&&te(g,c,1,p,i)}),p}oe(()=>v(),()=>{const t=Array.isArray(v())?v().filter(Boolean):[];U(J,t.map(r=>({name:r?.NAME??"(ไม่มีชื่อ)",children:j(r?.DATA)})))}),oe(()=>(e(J),e(a)),()=>{U(G,pe(e(J),e(a)))}),Je(),$e();var ae=Ye(),H=P(ae),ue=o(H);{var ve=t=>{var r=Xe(),p=o(r);ie(p,5,()=>e(J),Oe,($,u,i)=>{var c=le(),g=P(c);Ke(g,()=>i,C=>{var w=Ue(),E=o(w);E.__click=()=>ee(String(i));var K=o(E),_e=o(K,!0);n(K);var re=B(K,2),he=o(re,!0);n(re),n(E);var be=B(E,2);{var ge=M=>{var z=Qe();ie(z,5,()=>(e(G),l(()=>e(G).filter(S=>S.rootIndex===i&&S.depth>=1))),S=>S.path,(S,s)=>{var R=Pe(),V=o(R),ye=o(V);{var xe=k=>{var m=Re();m.__click=()=>ee(e(s).path);var W=o(m),q=o(W,!0);n(W);var L=B(W,2),_=o(L,!0);n(L),n(m),I((f,y)=>{D(m,"aria-expanded",f),x(q,y),x(_,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))},[()=>(e(a),e(s),l(()=>e(a).has(e(s).path))),()=>(e(a),e(s),l(()=>e(a).has(e(s).path)?"folder_open":"folder"))]),d(k,m)},Ae=k=>{var m=le(),W=P(m);{var q=_=>{var f=Ve(),y=o(f),we=o(y,!0);n(y);var ne=B(y,2),Se=o(ne,!0);n(ne),n(f),I(ke=>{D(f,"href",(e(s),l(()=>e(s).node.url))),D(f,"title",(e(s),l(()=>e(s).node.url))),x(we,ke),x(Se,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))},[()=>(e(s),l(()=>de(e(s).node.url)))]),d(_,f)},L=_=>{var f=qe(),y=o(f,!0);n(f),I(()=>x(y,(e(s),l(()=>e(s).node?.name??"(ไม่มีชื่อ)")))),d(_,f)};N(W,_=>{e(s),l(()=>e(s).node?.url)?_(q):_(L,!1)},!0)}d(k,m)};N(ye,k=>{e(s),l(()=>F(e(s).node?.children).length>0)?k(xe):k(Ae,!1)})}n(V),n(R),I(()=>Te(V,`--depth: ${e(s),l(()=>e(s).depth)??""}`)),d(S,R)}),n(z),d(M,z)};N(be,M=>{e(a),l(()=>e(a).has(String(i)))&&M(ge)})}n(w),I((M,z)=>{D(E,"aria-expanded",M),x(_e,z),x(he,(e(u),l(()=>e(u)?.name??"(ไม่มีชื่อ)")))},[()=>(e(a),l(()=>e(a).has(String(i)))),()=>(e(a),l(()=>e(a).has(String(i))?"folder_open":"folder"))]),d(C,w)}),d($,c)}),n(p),n(r),d(t,r)};N(ue,t=>{v(),l(()=>Array.isArray(v())&&v().length>0)&&t(ve)})}n(H);var se=B(H,2),me=B(o(se),2);me.__click=async()=>{Y.slide.destroy(),await fe()},n(se),d(A,ae),Le(),T()}Be(["click"]);export{ct as component};

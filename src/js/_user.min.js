import { local, isExpire } from "../appscript/classx.min.js"; import { updateTerminal } from "./_terminal.min.js"; import { LoadSetting } from "./_setting.min.js"; var user = { element: document.querySelector("#desktop #user"), profile: void 0 }; function initUser() { if (!user?.element) return; const e = local("user"); if (e) try { user.profile = JSON.parse(e), user.profile.exp && !isExpire(user.profile.exp) ? (user.element.style.cursor = "default", user.element.querySelector(".picture").classList.remove("user-guest"), user.element.querySelector(".title").textContent = user.profile.name, user.element.querySelector(".sub-title").textContent = user.profile.email, user.element.querySelector(".picture").innerHTML = `<img class='img-profile' src='${user.profile.picture}'>`) : (sessionStorage.setItem("LOG", "token expire"), localStorage.removeItem("user")) } catch (e) { sessionStorage.setItem("LOG", e), localStorage.removeItem("user") } else user.profile = void 0, user.element.style.cursor = "pointer", user.element.querySelector(".picture").innerHTML = `<img alt="userimg" title='userimg' class='img-profile' src='./src/img/avatar/avatar-${Math.floor(7 * Math.random()) + 1}.svg'>`, user.element.querySelector(".title").textContent = "Guest", user.element.addEventListener("click", handleLogin); LoadSetting(), updateTerminal() } function handleLogin(e) { login() } function login() { } export { user, initUser, login }
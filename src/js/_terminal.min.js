import { shortcutList } from "./_class-data.min.js"; import { user } from "./_user.min.js"; import { completion } from "./_terminal_completion.min.js"; import { functions } from "./_terminal_functions.min.js"; import { onWindowOpen, onWindowClose } from "./main.min.js"; import "./jquery-3.7.1.min.js"; import "./jquery.terminal-2.37.2.min.js"; import "./jquery.terminal.autocomplete.menu.min.js"; var terminalList = []; const parent = document.querySelector("#desktop"), TerminalSetting = { greetings: "Class X { ... }\nสวัสดีชาวโลก :/\n รายละเอียดเพิ่มเติม พิมพ์ '--help'.\n", autocompleteMenu: !0, prompt: "Guest@x.class > ", completion }, createTerminalShortcut = () => { if (!parent) return; const e = document.createElement("x-shortcut"); e.setAttributes({ name: "Terminal", icon: "url('./src/img/terminal-svgrepo-com.svg')" }); const t = 120 + 115 * shortcutList.length; e.style.top = t + "px", shortcutList.push({ key: "terminal", element: e }), e.handleOnClick = createTerminal, parent.appendChild(e) }; function createTerminal() { const e = document.createElement("x-window"); e.id = e.uid, e.setAttributes({ "window-width": .95 * document.documentElement.clientWidth + "px", "window-title": "Terminal" }), e.doBeforeCreate = onWindowOpen, document.body.appendChild(e), e.style.top = "0", e.style.left = "0", e.style.width = "100vw", e.windowElement.classList.add("maximize"); const t = getPrompt(), n = $(e.contentElement).terminal(functions, TerminalSetting).data("id", e.id).set_prompt(t); e.handleBeforeClose = () => { onWindowClose(e), removeTerminalFromList(e.id) }, terminalList.push({ id: e.id, terminal: n }) } function updateTerminal() { for (const e of terminalList) { const t = e.terminal; t && t.set_prompt(getPrompt()) } } function getPrompt() { let e = "Guest@x.class > "; return user.profile?.email && (e = user.profile.email + " > "), e } function removeTerminalFromList(e) { terminalList.filter((t => t.id === e))[0].terminal.purge(); const t = terminalList.filter((t => t.id !== e)); terminalList.splice(0, terminalList.length, ...t) } export { updateTerminal, createTerminalShortcut, terminalList, removeTerminalFromList, createTerminal }